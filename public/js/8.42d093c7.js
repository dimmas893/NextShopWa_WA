(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{2502:function(t,e,a){},"39a9":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"bg-grey-1 q-pb-lg",class:{"flex flex-center":!t.carts.items.length}},[a("q-header",{staticClass:"text-primary bg-white box-shadow"},[a("q-toolbar",[a("q-btn",{attrs:{to:{name:"ProductIndex"},flat:"",round:"",dense:"",icon:"arrow_back"}}),a("q-toolbar-title",{staticClass:"text-weight-bold brand"},[t._v("Keranjang Belanja")])],1)],1),t.carts.items.length?a("div",{},[a("q-card",{staticClass:"shadow q-py-sm q-mt-sm",attrs:{square:""}},[a("div",{staticClass:"q-px-md q-py-sm text-md text-weight-bold"},[t._v("\n        Detil Pesanan\n      ")]),a("q-list",{staticClass:"bg-white text-grey-10",attrs:{separator:""}},t._l(t.carts.items,(function(e){return a("q-item",{key:e.sku},[a("q-item-section",{staticClass:"q-pr-sm",attrs:{side:""}},[a("q-img",{staticStyle:{width:"90px",height:"90px"},attrs:{src:e.image_url}})],1),a("q-item-section",[a("div",{staticClass:"col overflow-hidden full-width column"},[a("div",[a("div",{staticClass:"flex justify-between items-center"},[a("div",{staticClass:"text-weight-medium ellipsis text-md"},[t._v(t._s(e.name))]),a("q-btn",{attrs:{outline:"",size:"10px",color:"red","no-caps":"",padding:"2px 4px"},on:{click:function(a){return t.removeCart(e)}}},[t._v("hapus")])],1),a("div",{staticClass:"text-grey-7 q-mb-xs text-caption"},[t._v("Catatan: "+t._s(e.note?e.note:"-"))])]),a("div",{staticClass:"flex items-center justify-between q-mt-auto"},[a("div",{staticClass:"text-weight-medium"},[t._v("Harga "+t._s(t.moneyIDR(e.price)))]),a("div",{staticClass:"q-gutter-x-sm items-center"},[a("q-btn",{staticStyle:{cursor:"pointer"},attrs:{flat:"",padding:"4px",round:"",icon:"remove_circle_outline",size:"13px"},on:{click:function(a){return t.decrementQty(e)}}}),a("span",{staticClass:"text-weight-medium text-md"},[t._v(t._s(e.quantity))]),a("q-btn",{staticStyle:{cursor:"pointer"},attrs:{flat:"",padding:"4px",round:"",icon:"add_circle_outline",size:"13px"},on:{click:function(a){return t.incrementQty(e)}}})],1)])])])],1)})),1)],1),a("q-card",{staticClass:"shadow q-mt-lg q-py-sm",attrs:{square:""}},[a("div",{staticClass:"q-px-md q-py-sm text-md text-weight-bold"},[t._v("\n        Pengiriman\n      ")]),a("div",{staticClass:"q-px-md"},[a("keep-alive",[a("map-component",{attrs:{config:t.config,coordinate:t.config.warehouse_coordinate},on:{emitData:t.emitData}})],1),t.errors.includes("shipping_cost")?a("div",{staticClass:"text-red text-xs q-py-sm"},[t._v("Pengiriman belum dipilih")]):t._e()],1)]),a("q-card",{staticClass:"shadow q-mt-lg q-py-sm",attrs:{square:""}},[a("q-card-section",[a("div",{staticClass:"q-pa-sm"},[a("div",{staticClass:"text-md q-pb-xs text-weight-bold"},[t._v("Informasi Pengguna")]),a("div",{staticClass:"q-mt-md q-mb-xs"},[t._v("Nama lengkap")]),a("q-input",{attrs:{outlined:"",dense:"","stack-label":""},model:{value:t.form.customer_name,callback:function(e){t.$set(t.form,"customer_name",e)},expression:"form.customer_name"}}),t.errors.includes("customer_name")?a("div",{staticClass:"text-red text-xs q-py-xs"},[t._v("Nama tidak boleh kosong")]):t._e(),a("div",{staticClass:"q-mt-md q-mb-xs"},[t._v("No Whatsapp")]),a("q-input",{attrs:{outlined:"",dense:"","stack-label":"",mask:"##############"},model:{value:t.form.customer_whatsapp,callback:function(e){t.$set(t.form,"customer_whatsapp",e)},expression:"form.customer_whatsapp"}}),t.errors.includes("customer_whatsapp")?a("div",{staticClass:"text-red text-xs q-py-xs"},[t._v("Nomor Whatsapp tidak boleh kosong")]):t._e(),a("div",{staticClass:"q-mt-md q-mb-xs"},[t._v("Alamat lengkap")]),a("q-input",{attrs:{outlined:"",rows:"3",debounce:"1000",type:"textarea"},model:{value:t.form.customer_address,callback:function(e){t.$set(t.form,"customer_address",e)},expression:"form.customer_address"}}),t.errors.includes("customer_address")?a("div",{staticClass:"text-red text-xs q-py-xs"},[t._v("Alaman tidak boleh kosong")]):t._e(),a("div",{staticClass:"q-mt-md q-mb-xs"},[t._v("Catatan Tambahan ( bila ada )")]),a("q-input",{attrs:{type:"textarea",rows:"2",outlined:""},model:{value:t.form.order_note,callback:function(e){t.$set(t.form,"order_note",e)},expression:"form.order_note"}})],1)])],1),a("q-footer",{staticClass:"bg-white q-py-sm q-px-md"},[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"text-md text-dark"},[t._v("Total")]),a("div",{staticClass:"text-md2 text-weight-bold text-secondary"},[t._v(t._s(t.moneyIDR(t.sumtotal())))])]),a("q-btn",{staticClass:"full-width q-mt-sm",attrs:{unelevated:"",color:"green-6","no-caps":""},on:{click:t.checkout}},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 50 50",width:"20px",height:"20px"}},[a("g",{attrs:{id:"surface1441897"}},[a("path",{staticStyle:{stroke:"none","fill-rule":"nonzero",fill:"currentColor","fill-opacity":"1"},attrs:{d:"M 25 2 C 12.316406 2 2 12.316406 2 25 C 2 28.960938 3.023438 32.855469 4.964844 36.289062 L 2.035156 46.730469 C 1.941406 47.074219 2.035156 47.441406 2.28125 47.695312 C 2.472656 47.894531 2.734375 48 3 48 C 3.078125 48 3.160156 47.988281 3.238281 47.972656 L 14.136719 45.273438 C 17.464844 47.058594 21.210938 48 25 48 C 37.683594 48 48 37.683594 48 25 C 48 12.316406 37.683594 2 25 2 Z M 36.570312 33.117188 C 36.078125 34.476562 33.71875 35.722656 32.585938 35.886719 C 31.566406 36.035156 30.277344 36.101562 28.863281 35.65625 C 28.007812 35.386719 26.90625 35.027344 25.496094 34.429688 C 19.574219 31.902344 15.707031 26.011719 15.410156 25.625 C 15.117188 25.234375 13 22.464844 13 19.59375 C 13 16.726562 14.523438 15.3125 15.066406 14.730469 C 15.609375 14.144531 16.246094 14 16.640625 14 C 17.035156 14 17.429688 14.003906 17.773438 14.019531 C 18.136719 14.039062 18.625 13.882812 19.101562 15.023438 C 19.59375 16.191406 20.777344 19.058594 20.921875 19.351562 C 21.070312 19.644531 21.167969 19.984375 20.972656 20.375 C 20.777344 20.761719 20.679688 21.007812 20.382812 21.347656 C 20.085938 21.6875 19.761719 22.105469 19.496094 22.367188 C 19.199219 22.660156 18.894531 22.976562 19.238281 23.558594 C 19.582031 24.144531 20.765625 26.050781 22.523438 27.597656 C 24.777344 29.585938 26.679688 30.199219 27.269531 30.492188 C 27.859375 30.785156 28.203125 30.734375 28.550781 30.347656 C 28.894531 29.957031 30.023438 28.644531 30.417969 28.058594 C 30.8125 27.476562 31.203125 27.574219 31.746094 27.769531 C 32.289062 27.960938 35.191406 29.371094 35.78125 29.664062 C 36.371094 29.957031 36.765625 30.101562 36.914062 30.34375 C 37.0625 30.585938 37.0625 31.753906 36.570312 33.117188 Z M 36.570312 33.117188 "}})])]),a("span",{staticClass:"q-ml-sm"},[t._v("\n         Pesan Sekarang\n        ")])])],1)],1):t._e(),t.carts.items.length?t._e():a("div",{staticClass:"column items-center"},[a("p",{staticClass:"text-grey-8 text-weight-bold text-center"},[t._v("Keranjang belanja anda masih kosong!")]),a("q-btn",{attrs:{unelevated:"",to:{name:"ProductIndex"},rounded:"","text-color":"white",color:"primary",icon:"keyboard_backspace",label:"kembali berbelanja","no-caps":""}})],1)],1)},i=[],s=a("ded3"),o=a.n(s),r=(a("ac1f"),a("5319"),a("2ca0"),a("1276"),a("a15b"),a("159b"),a("99af"),a("b0c0"),a("2f62")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"relative"},[a("div",{staticClass:"relative input-map q-pb-md"},[a("div",{},[a("div",{staticClass:"text-grey-8 q-pb-sm text-sm"},[t._v("Gunakan form pencarian atau klik tujuan di dalam map dan juga dapat menggunakan tombol lokasi terkini untuk mendapatkan tujuan pengiriman.")]),a("q-input",{attrs:{clearable:"",loading:t.searchLoading,outlined:"",dense:"",placeholder:"Ketik tempat anda..."},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery(e)},input:t.inputQuery},scopedSlots:t._u([t.searchLoading?null:{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"},on:{click:t.searchQuery}})]},proxy:!0}],null,!0),model:{value:t.query,callback:function(e){t.query=e},expression:"query"}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],staticClass:"list-box-content"},[a("q-list",{attrs:{separator:""}},[t._l(t.lists,(function(e,n){return a("q-item",{key:n,attrs:{clickable:""},on:{click:function(a){return t.selectItemList(e)}}},[a("q-item-section",[t._v(t._s(e.label))])],1)})),t.notFound?a("q-item",[a("q-item-section",{staticClass:"text-center"},[t._v("Data tidak ditemukan")])],1):t._e()],2)],1),a("div",{staticClass:"relative"},[a("div",{attrs:{id:"mapContainer"}}),a("q-btn",{staticClass:"bg-white text-grey-7 btn-floating",attrs:{flat:"",icon:"my_location",loading:t.loading,round:"",dense:"",padding:"sm"},on:{click:t.getCurrentPosition}})],1)])},l=[],u=(a("d3b7"),a("e6cf"),a("a79d"),a("841c"),a("d81d"),a("b680"),a("6cc5"),a("e11e")),d=a.n(u),m=a("ac00"),p=(a("1cc7"),a("5bfd"),a("1615"),a("125d"),a("5c7a"),{name:"Map",props:["coordinate","config"],data:function(){return{map:null,zoom:12,routeControl:null,searchControl:null,originMarker:null,destinationMarker:null,destinationCenter:null,originMarkerOption:{clickable:!1,draggable:!1,icon:null},destinationMarkerOption:{clickable:!0,draggable:!0,autoPan:!0,icon:null},query:"",provider:null,lists:[],listSelected:null,searchLoading:!1,notFound:!1,geocoder:null,totalDistanceKm:0,totaldistanceMinutes:0,freeOngkirUnder:2,hargaJarakPerKm:0,loading:!1,lastLocalCost:0,maxDistance:0,user_coordinate:[]}},mounted:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t.initialMap()}),1e3)}))},watch:{totalDistanceKm:function(){this.getLocalCost()}},computed:{showList:function(){return this.lists.length||this.notFound}},methods:{getLocalCost:function(){var t=this;if(this.config&&this.config.shipping_costs.length){var e=this.config.shipping_costs,a=e[e.length-1];this.maxDistance=parseInt(a.end),this.hargaJarakPerKm=parseInt(a.cost),this.lastLocalCost=parseInt(a.cost);for(var n=0;n<e.length;n++)if(this.hargaJarakPerKm=parseInt(e[n].cost),this.totalDistanceKm>parseInt(e[n].start)&&this.totalDistanceKm<parseInt(e[n].end)){this.hargaJarakPerKm=parseInt(e[n].cost);break}if(this.totalDistanceKm>this.maxDistance)return void this.$q.dialog({title:"Tujuan diluar jangkauan!",message:"Mohon maaf sayangnya alamat tujuan diluar jangkauan kurir kami, Maksimal jangkauan kurir kami adalah ".concat(this.maxDistance,"KM.")});this.$emit("emitData",{amount:this.getOngkir(),user_coordinate:this.user_coordinate}),setTimeout((function(){void 0!=t.setDestinationMarker&&t.destinationMarker.bindTooltip(t.createPopup(),{permanent:!0,direction:"left"})}),500)}},searchQuery:function(){var t=this;this.notFound=!1,this.searchLoading=!0,this.provider.search({query:this.query}).then((function(e){t.lists=e})).finally((function(){t.searchLoading=!1,t.lists.length||(t.notFound=!0,setTimeout((function(){t.notFound=!1}),5e3))}))},inputQuery:function(){this.notFound=!1},selectItemList:function(t){this.listSelected=t;var e=[t.y,t.x];this.lists=[],this.setMapView(),this.setDestinationMarker(e)},initialMap:function(){this.provider=new m["a"]({params:{countrycodes:"id"}}),this.originMarkerOption.icon=d.a.icon({iconUrl:"/static/warehouse.png",iconSize:[40,40],iconAnchor:[20,40]}),this.destinationMarkerOption.icon=d.a.icon({iconUrl:"/static/delivery.png",iconSize:[40,40],iconAnchor:[20,40]}),this.map=d.a.map("mapContainer",{center:this.coordinate,zoom:this.zoom}),this.config&&this.config.mapbox_access_token?d.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=".concat(this.config.mapbox_access_token),{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:20,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1}).addTo(this.map):d.a.tileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.originMarker=d.a.marker(this.coordinate,this.originMarkerOption),this.originMarker.addTo(this.map),this.setRouteControl(),this.map.on("click",this.handleMapClicked)},setGeocoder:function(){var t=this;d.a.Control.geocoder({defaultMarkGeocode:!1,geocoder:d.a.Control.Geocoder.nominatim(),style:"bar"}).on("markgeocode",(function(e){t.setDestinationMarker(e.geocode.center)})).addTo(this.map)},handleMapClicked:function(t){var e=this,a=d.a.DomUtil.create("div"),n=d.a.DomUtil.create("button","",a);n.setAttribute("type","button"),n.innerHTML="Pilih lokasi disini",d.a.popup().setContent(a).setLatLng(t.latlng).openOn(this.map),d.a.DomEvent.on(n,"click",(function(){e.setDestinationMarker([t.latlng.lat,t.latlng.lng])}))},setDestinationMarker:function(t){this.user_coordinate=t,this.destinationCenter?this.routeControl.spliceWaypoints(1,this.routeControl.getWaypoints().length,t):this.routeControl.setWaypoints([this.coordinate,t]),this.map.closePopup(),this.destinationCenter=t,this.map.setView(t),this.loading=!1},setRouteControl:function(){var t=this,e={createMarker:function(){return null},geocoder:this.provider,show:!1};this.config&&this.config.mapbox_access_token&&(e={createMarker:function(){return null},geocoder:this.provider,show:!1,router:d.a.Routing.mapbox(this.config.mapbox_access_token)}),this.routeControl=d.a.Routing.control(e).addTo(this.map),this.routeControl.on("routeselected",(function(e){var a=e.route;t.totalDistanceKm=(e.route.summary.totalDistance/1e3).toFixed(1),t.totaldistanceMinutes=Math.round(e.route.summary.totalTime%3600/60),void 0!=t.destinationMarker&&t.map.removeLayer(t.destinationMarker),t.destinationMarker=d.a.marker([a.coordinates[a.coordinates.length-1].lat,a.coordinates[a.coordinates.length-1].lng],t.destinationMarkerOption),t.destinationMarker.on("dragend",(function(e){var a=e.target._latlng;t.setDestinationMarker([a.lat,a.lng])})),"routeselected"===e.type&&t.map.addLayer(t.destinationMarker)}))},setMapView:function(){var t=this;setTimeout((function(){t.map.setView(t.coordinate),t.map.closePopup()}),500)},getAutoPosition:function(){var t=this;setTimeout((function(){t.getCurrentPosition()}),2e3)},getCurrentPosition:function(){this.loading=!0;var t={enableHighAccuracy:!0,timeout:8e3,maximumAge:0};navigator.geolocation?navigator.geolocation.getCurrentPosition(this.geoLocationSuccess,this.geoLocationError,t):this.$q.notify({type:"warning",message:"Geolocation is not supported by this browser."})},geoLocationError:function(){this.loading=!1,this.$q.notify({type:"warning",message:"Lokasi tidak ditemukan, coba ulangi sekali lagi."})},geoLocationSuccess:function(t){var e=this;setTimeout((function(){e.setDestinationMarker([t.coords.latitude,t.coords.longitude])}),500)},createPopup:function(){return console.log("create popup"),'<div class="marker-tooltip">\n              <div class="details-text">Jarak : <b>'.concat(this.totalDistanceKm,' Km</b></div>\n              <div class="details-text">ongkos kirim / km <b>').concat(this.moneyIDR(this.hargaJarakPerKm),'</b></div>\n              <div class="details-text">Total Ongkos Kirim: <b> ').concat(this.formatOngkir()," </b></div>\n            </div>")},getOngkir:function(){return this.totalDistanceKm>0?Math.round(this.totalDistanceKm*this.hargaJarakPerKm):0},formatOngkir:function(){return this.totalDistanceKm>0?this.moneyIDR(this.getOngkir()):"Gratis"}}}),h=p,g=(a("c6c5"),a("2877")),f=a("27f9"),k=a("0016"),v=a("1c1c"),b=a("66e5"),C=a("4074"),_=a("9c40"),x=a("eebe"),y=a.n(x),q=Object(g["a"])(h,c,l,!1,null,"2680c38a",null),w=q.exports;y()(q,"components",{QInput:f["a"],QIcon:k["a"],QList:v["a"],QItem:b["a"],QItemSection:C["a"],QBtn:_["a"]});var M={name:"CartPage",components:{"map-component":w},data:function(){return{errors:[],form:{customer_name:"",customer_whatsapp:"",customer_address:"",order_note:"",shipping_cost:0,user_coordinate:[]}}},computed:o()(o()({},Object(r["e"])({shop:function(t){return t.shop},config:function(t){return t.config},user:function(t){return t.user.user}})),{},{carts:function(){return this.$store.getters["cart/getCarts"]},session_id:function(){return this.$store.state.session_id},canCheckout:function(){return this.form.shipping_cost&&this.form.customer_name&&this.form.customer_whatsapp&&this.form.customer_address}}),created:function(){this.shop||this.$store.dispatch("getShop")},methods:{checkout:function(){this.checkForm(),this.errors.length||this.goToWhatsapp()},emitData:function(t){this.form.shipping_cost=t.amount,this.form.user_coordinate=t.user_coordinate,this.errors=[]},incrementQty:function(t){if(!(parseInt(t.quantity)>=parseInt(t.product_stock))){var e=parseInt(t.quantity)+1;this.$store.dispatch("cart/updateCart",{sku:t.sku,quantity:e})}},decrementQty:function(t){if(!(parseInt(t.quantity)<=1)){var e=parseInt(t.quantity)-1;this.$store.dispatch("cart/updateCart",{sku:t.sku,quantity:e})}},removeCart:function(t){this.$store.dispatch("cart/removeCart",{sku:t.sku,session_id:t.session_id})},checkForm:function(){var t=this;for(var e in this.form)"order_note"!=e&&(this.form[e]||this.errors.push(e));setTimeout((function(){return t.errors=[]}),2e4)},formatPhoneNumber:function(t){var e=t.replace(/\D/g,"");return e.startsWith("0")&&(e="62"+e.substr(1)),e},formatAddressCod:function(t){var e=t.split("<br>");return e.join("\n")},goToWhatsapp:function(){var t=this,e="https://api.whatsapp.com";this.$q.platform.is.desktop&&(e="https://web.whatsapp.com");var a=this.formatPhoneNumber(this.shop.phone),n="Halo kak, saya mau order:\n\n",i=this.carts.items,s=1;i.forEach((function(e){n+="*".concat(s,". ").concat(e.name,"*\n"),e.note&&(n+="[".concat(e.note,"]\n")),n+="Jumlah: ".concat(e.quantity,"\nHarga (@): ").concat(t.moneyIDR(e.price),"\nHarga Total: ").concat(t.moneyIDR(e.quantity*e.price),"\n\n"),s++})),n+="Subtotal: *".concat(this.moneyIDR(this.carts.subtotal),"*\n"),this.form.shipping_cost&&(n+="Ongkir: *".concat(this.moneyIDR(this.form.shipping_cost),"*\n")),n+="Total: *".concat(this.moneyIDR(this.sumtotal()),"*\n"),n+="-------------------------------------------------\n\n",n+="*Nama:*\n".concat(this.form.customer_name," (").concat(this.form.customer_whatsapp,")\n"),n+="*Alamat:*\n".concat(this.formatAddressCod(this.form.customer_address),"\n"),this.form.order_note&&(n+="*Catatan:*\n".concat(this.form.order_note,"\n"));var o="https://www.google.com/maps/place";this.form.user_coordinate.length&&(n+="*Lokasi:*\n".concat(o,"/").concat(this.form.user_coordinate[0],",").concat(this.form.user_coordinate[1]));var r=e+"/send?phone="+a+"&text="+encodeURI(n);setTimeout((function(){t.$store.dispatch("cart/clearCart")}),3e3),window.open(r,"_blank")},sumtotal:function(){return this.carts.subtotal+this.form.shipping_cost}},meta:function(){return{title:"Keranjang Belanja"}}},D=M,I=(a("cc0d"),a("9989")),L=a("e359"),Q=a("65c6"),P=a("6ac5"),T=a("f09f"),K=a("068f"),j=a("a370"),O=a("7ff0"),S=a("8572"),$=Object(g["a"])(D,n,i,!1,null,"38c304fa",null);e["default"]=$.exports;y()($,"components",{QPage:I["a"],QHeader:L["a"],QToolbar:Q["a"],QBtn:_["a"],QToolbarTitle:P["a"],QCard:T["a"],QList:v["a"],QItem:b["a"],QItemSection:C["a"],QImg:K["a"],QCardSection:j["a"],QInput:f["a"],QFooter:O["a"],QField:S["a"]})},c6c5:function(t,e,a){"use strict";a("2502")},cc0d:function(t,e,a){"use strict";a("deb9")},deb9:function(t,e,a){}}]);